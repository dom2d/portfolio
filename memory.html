<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Themed Memory Match</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            width: 100%;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .theme-title {
            font-size: 1.2rem;
            opacity: 0.95;
            margin-bottom: 5px;
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 15px;
        }

        .stat {
            background: rgba(255,255,255,0.2);
            padding: 10px 20px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        .stat-label {
            font-size: 0.85rem;
            opacity: 0.9;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .goals {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 10px;
            font-size: 0.9rem;
        }

        .goal {
            opacity: 0.85;
        }

        .goal.achieved {
            font-weight: bold;
            opacity: 1;
        }

        .game-board {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 12px;
            margin: 0 auto;
            max-width: 700px;
        }

        .card {
            aspect-ratio: 1/1;
            background: white;
            border-radius: 12px;
            cursor: pointer;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.6s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .card.flipped {
            transform: rotateY(180deg);
        }

        .card.matched {
            cursor: default;
            border: 3px solid gold;
            animation: rainbowGlow 2s infinite;
        }
        
        @keyframes rainbowGlow {
            0% { border-color: #ff0000; }
            14% { border-color: #ff7f00; }
            28% { border-color: #ffff00; }
            42% { border-color: #00ff00; }
            57% { border-color: #0000ff; }
            71% { border-color: #4b0082; }
            85% { border-color: #9400d3; }
            100% { border-color: #ff0000; }
        }
        
        .card.matched .card-front {
            background: #f0f0f0;
            color: #999;
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px;
            border-radius: 12px;
            font-weight: 600;
            text-align: center;
            word-wrap: break-word;
            overflow-wrap: break-word;
            hyphens: auto;
        }

        .card-back {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: 2rem;
            border: 8px solid white;
        }

        .card-front {
            background: white;
            color: #333;
            transform: rotateY(180deg);
            font-size: 0.95rem;
            line-height: 1.3;
        }

        .controls {
            text-align: center;
            margin-top: 30px;
        }

        .btn {
            background: white;
            color: #667eea;
            border: none;
            padding: 12px 30px;
            font-size: 1rem;
            font-weight: bold;
            border-radius: 25px;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .win-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            text-align: center;
            display: none;
            z-index: 1000;
        }

        .win-message.show {
            display: block;
            animation: slideIn 0.5s;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translate(-50%, -60%);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%);
            }
        }

        .win-message h2 {
            color: #667eea;
            font-size: 2rem;
            margin-bottom: 20px;
        }

        .win-message .medal {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .win-message p {
            font-size: 1.2rem;
            color: #666;
            margin-bottom: 25px;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            z-index: 999;
        }

        .overlay.show {
            display: block;
        }
        
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #f0f;
            position: absolute;
            animation: confetti-fall linear forwards;
            z-index: 998;
        }
        
        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <div class="overlay" id="overlay"></div>
    
    <div class="container">
        <div class="header">
            <h1>ðŸ§  Memory Match</h1>
            <div class="theme-title" id="themeTitle">Anagrams</div>
            <div class="stats">
                <div class="stat">
                    <div class="stat-label">Flips</div>
                    <div class="stat-value" id="flips">0</div>
                </div>
                <div class="stat">
                    <div class="stat-label">Pairs</div>
                    <div class="stat-value" id="pairs">0/10</div>
                </div>
            </div>
            <div class="goals">
                <div class="goal" id="gold">ðŸ¥‡ Gold: 30</div>
                <div class="goal" id="silver">ðŸ¥ˆ Silver: 40</div>
                <div class="goal" id="bronze">ðŸ¥‰ Bronze: 50</div>
            </div>
        </div>

        <div class="game-board" id="gameBoard"></div>

        <div class="controls">
            <button class="btn" onclick="newGame()">New Game</button>
        </div>
    </div>

    <div class="win-message" id="winMessage">
        <div class="medal" id="medal"></div>
        <h2>Congratulations!</h2>
        <p id="winText"></p>
        <div style="display: flex; gap: 10px; justify-content: center;">
            <button class="btn" onclick="shareScore()">Share ðŸŽ‰</button>
            <button class="btn" onclick="newGame()">Play Again</button>
        </div>
    </div>

    <script>
        const themes = [
            {
                name: "Anagrams",
                pairs: [
                    ["astronomer", "moon starer"],
                    ["the eyes", "they see"],
                    ["dormitory", "dirty room"],
                    ["conversation", "voices rant on"],
                    ["eleven plus two", "twelve plus one"],
                    ["a gentleman", "elegant man"],
                    ["debit card", "bad credit"],
                    ["the countryside", "no city dust here"],
                    ["listen", "silent"],
                    ["Elvis", "lives"]
                ],
                goals: { gold: 30, silver: 40, bronze: 50 }
            },
            {
                name: "Famous Couples",
                pairs: [
                    ["Barack Obama", "Michelle Obama"],
                    ["Brad Pitt", "Angelina Jolie"],
                    ["David Beckham", "Victoria Beckham"],
                    ["Jay-Z", "BeyoncÃ©"],
                    ["Prince William", "Kate Middleton"],
                    ["Ryan Reynolds", "Blake Lively"],
                    ["John Legend", "Chrissy Teigen"],
                    ["Justin Timberlake", "Jessica Biel"],
                    ["Tom Hanks", "Rita Wilson"],
                    ["George Clooney", "Amal Clooney"]
                ],
                goals: { gold: 30, silver: 40, bronze: 50 }
            },
            {
                name: "Love Around the World",
                pairs: [
                    ["French", "Amour"],
                    ["Spanish", "Amor"],
                    ["Italian", "Amore"],
                    ["German", "Liebe"],
                    ["Dutch", "Liefde"],
                    ["Russian", "Ð›ÑŽÐ±Ð¾Ð²ÑŒ"],
                    ["Japanese", "æ„›"],
                    ["Korean", "ì‚¬ëž‘"],
                    ["Greek", "Î‘Î³Î¬Ï€Î·"],
                    ["Turkish", "AÅŸk"]
                ],
                goals: { gold: 30, silver: 40, bronze: 50 }
            },
            {
                name: "Capitals & Countries",
                pairs: [
                    ["Paris", "France"],
                    ["Tokyo", "Japan"],
                    ["London", "United Kingdom"],
                    ["Berlin", "Germany"],
                    ["Rome", "Italy"],
                    ["Madrid", "Spain"],
                    ["Ottawa", "Canada"],
                    ["Cairo", "Egypt"],
                    ["Moscow", "Russia"],
                    ["Beijing", "China"]
                ],
                goals: { gold: 30, silver: 40, bronze: 50 }
            },
            {
                name: "Emoji Names",
                pairs: [
                    ["ðŸ˜‚", "Face with Tears of Joy"],
                    ["â¤ï¸", "Red Heart"],
                    ["ðŸ”¥", "Fire"],
                    ["ðŸ‘", "Thumbs Up"],
                    ["ðŸŽ‰", "Party Popper"],
                    ["ðŸŒŸ", "Glowing Star"],
                    ["ðŸŒˆ", "Rainbow"],
                    ["ðŸ¦„", "Unicorn"],
                    ["ðŸ•", "Pizza"],
                    ["â˜•", "Hot Beverage"]
                ],
                goals: { gold: 30, silver: 40, bronze: 50 }
            },
            {
                name: "Foreign Films",
                pairs: [
                    ["La Vita Ã¨ Bella", "Life Is Beautiful"],
                    ["Le Fabuleux Destin d'AmÃ©lie Poulain", "AmÃ©lie"],
                    ["Sen to Chihiro no Kamikakushi", "Spirited Away"],
                    ["El Laberinto del Fauno", "Pan's Labyrinth"],
                    ["Das Leben der Anderen", "The Lives of Others"],
                    ["Cidade de Deus", "City of God"],
                    ["La Haine", "Hate"],
                    ["Oldboy", "Oldboy"],
                    ["Intouchables", "The Intouchables"],
                    ["Parasite", "ê¸°ìƒì¶©"]
                ],
                goals: { gold: 30, silver: 40, bronze: 50 }
            },
            {
                name: "TV Shows & Characters",
                pairs: [
                    ["Breaking Bad", "Walter White"],
                    ["Game of Thrones", "Jon Snow"],
                    ["Friends", "Rachel Green"],
                    ["The Office", "Michael Scott"],
                    ["Stranger Things", "Eleven"],
                    ["The Crown", "Queen Elizabeth II"],
                    ["Sherlock", "Sherlock Holmes"],
                    ["Mad Men", "Don Draper"],
                    ["The Sopranos", "Tony Soprano"],
                    ["House", "Dr. Gregory House"]
                ],
                goals: { gold: 30, silver: 40, bronze: 50 }
            }
        ];

        let currentTheme;
        let cards = [];
        let flippedCards = [];
        let matchedPairs = 0;
        let flipCount = 0;
        let canFlip = true;

        function shuffle(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function newGame() {
            // Select random theme
            currentTheme = themes[Math.floor(Math.random() * themes.length)];
            
            // Validate theme - check for duplicate values
            const allValues = currentTheme.pairs.flat();
            const duplicates = allValues.filter((item, index) => allValues.indexOf(item) !== index);
            if (duplicates.length > 0) {
                console.warn(`Warning: Theme "${currentTheme.name}" has duplicate values:`, duplicates);
            }
            
            // Reset game state
            matchedPairs = 0;
            flipCount = 0;
            flippedCards = [];
            canFlip = true;
            
            // Update UI
            document.getElementById('themeTitle').textContent = currentTheme.name;
            document.getElementById('flips').textContent = '0';
            document.getElementById('pairs').textContent = '0/10';
            document.getElementById('gold').textContent = `ðŸ¥‡ Gold: ${currentTheme.goals.gold}`;
            document.getElementById('silver').textContent = `ðŸ¥ˆ Silver: ${currentTheme.goals.silver}`;
            document.getElementById('bronze').textContent = `ðŸ¥‰ Bronze: ${currentTheme.goals.bronze}`;
            
            // Reset goal highlights
            document.getElementById('gold').classList.remove('achieved');
            document.getElementById('silver').classList.remove('achieved');
            document.getElementById('bronze').classList.remove('achieved');
            
            // Hide win message
            document.getElementById('winMessage').classList.remove('show');
            document.getElementById('overlay').classList.remove('show');
            
            // Create card array - store unique card IDs for proper matching
            cards = [];
            currentTheme.pairs.forEach((pair, index) => {
                const cardId1 = `pair${index}_card0`;
                const cardId2 = `pair${index}_card1`;
                cards.push({ id: cardId1, value: pair[0], matchWith: cardId2 });
                cards.push({ id: cardId2, value: pair[1], matchWith: cardId1 });
            });
            
            // Shuffle cards
            cards = shuffle(cards);
            
            // Render board
            renderBoard();
        }

        function renderBoard() {
            const board = document.getElementById('gameBoard');
            board.innerHTML = '';
            
            cards.forEach((card, index) => {
                const cardElement = document.createElement('div');
                cardElement.className = 'card';
                cardElement.dataset.cardId = card.id;
                cardElement.dataset.matchWith = card.matchWith;
                cardElement.innerHTML = `
                    <div class="card-face card-back">?</div>
                    <div class="card-face card-front">${card.value}</div>
                `;
                cardElement.addEventListener('click', () => flipCard(cardElement, card));
                board.appendChild(cardElement);
            });
        }

        function flipCard(element, card) {
            if (!canFlip || element.classList.contains('flipped') || element.classList.contains('matched')) {
                return;
            }
            
            element.classList.add('flipped');
            flippedCards.push({ element, card });
            
            flipCount++;
            document.getElementById('flips').textContent = flipCount;
            updateGoals();
            
            if (flippedCards.length === 2) {
                canFlip = false;
                setTimeout(checkMatch, 800);
            }
        }

        function checkMatch() {
            const [first, second] = flippedCards;
            
            // Check if the cards are a valid match by checking their IDs
            if (first.card.matchWith === second.card.id) {
                // Match!
                first.element.classList.add('matched');
                second.element.classList.add('matched');
                matchedPairs++;
                document.getElementById('pairs').textContent = `${matchedPairs}/10`;
                
                if (matchedPairs === 10) {
                    setTimeout(showWin, 500);
                }
            } else {
                // No match
                first.element.classList.remove('flipped');
                second.element.classList.remove('flipped');
            }
            
            flippedCards = [];
            canFlip = true;
        }

        function updateGoals() {
            if (flipCount <= currentTheme.goals.gold) {
                document.getElementById('gold').classList.add('achieved');
            }
            if (flipCount <= currentTheme.goals.silver) {
                document.getElementById('silver').classList.add('achieved');
            }
            if (flipCount <= currentTheme.goals.bronze) {
                document.getElementById('bronze').classList.add('achieved');
            }
        }

        function showWin() {
            let medal = '';
            let message = '';
            
            if (flipCount <= currentTheme.goals.gold) {
                medal = 'ðŸ¥‡';
                message = `Amazing! Gold medal with ${flipCount} flips!`;
            } else if (flipCount <= currentTheme.goals.silver) {
                medal = 'ðŸ¥ˆ';
                message = `Great job! Silver medal with ${flipCount} flips!`;
            } else if (flipCount <= currentTheme.goals.bronze) {
                medal = 'ðŸ¥‰';
                message = `Well done! Bronze medal with ${flipCount} flips!`;
            } else {
                medal = 'âœ…';
                message = `Completed in ${flipCount} flips! Try for a medal next time!`;
            }
            
            document.getElementById('medal').textContent = medal;
            document.getElementById('winText').textContent = message;
            document.getElementById('winMessage').classList.add('show');
            document.getElementById('overlay').classList.add('show');
            
            // Trigger confetti
            createConfetti();
        }
        
        function createConfetti() {
            const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff', '#ffa500', '#ff69b4'];
            const confettiCount = 150;
            
            for (let i = 0; i < confettiCount; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDuration = (Math.random() * 3 + 2) + 's';
                    confetti.style.opacity = Math.random();
                    confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => confetti.remove(), 5000);
                }, i * 30);
            }
        }
        
        function shareScore() {
            const medal = flipCount <= currentTheme.goals.gold ? 'ðŸ¥‡' : 
                         flipCount <= currentTheme.goals.silver ? 'ðŸ¥ˆ' : 
                         flipCount <= currentTheme.goals.bronze ? 'ðŸ¥‰' : 'âœ…';
            const shareText = `I completed ${currentTheme.name} in ${flipCount} flips! ${medal}\n\nPlay Memory Match at dom2d.com/memory`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'Memory Match Score',
                    text: shareText
                }).catch(() => {
                    copyToClipboard(shareText);
                });
            } else {
                copyToClipboard(shareText);
            }
        }
        
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = 'Copied! âœ“';
                setTimeout(() => {
                    btn.textContent = originalText;
                }, 2000);
            });
        }

        // Start game on load
        newGame();
    </script>
</body>
</html>
