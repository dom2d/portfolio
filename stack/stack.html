<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NERDSTACK - Daily Stack Game</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@900&family=Archivo+Black&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --gold: #d4af37;
            --gold-light: #f4d03f;
            --white: #ffffff;
            --off-white: #e8e8e8;
            --black: #0a0a0f;
            --dark-gray: #1a1a1a;
            --mid-gray: #333333;
            --light-gray: #666666;
            --success: var(--gold);
            --error: #ff4444;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--black);
            color: var(--white);
            min-height: 100vh;
            overflow-x: hidden;
            overflow-y: auto;
            transition: background-color 0.5s ease;
        }

        .container {
            max-width: 1200px;
            width: 100%;
            margin: 0 auto;
            padding: 1rem;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        header {
            text-align: center;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid var(--mid-gray);
            position: relative;
        }

        h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5rem;
            font-weight: 900;
            letter-spacing: 6px;
            margin-bottom: 0.5rem;
            color: var(--gold);
            text-shadow: 0 0 20px rgba(212, 175, 55, 0.5);
        }

        h1 span {
            display: inline-block;
            animation: letterShift 3s ease-in-out infinite;
        }

        h1 span:nth-child(1) { animation-delay: 0s; }
        h1 span:nth-child(2) { animation-delay: 0.1s; }
        h1 span:nth-child(3) { animation-delay: 0.2s; }
        h1 span:nth-child(4) { animation-delay: 0.3s; }
        h1 span:nth-child(5) { animation-delay: 0.4s; }
        h1 span:nth-child(6) { animation-delay: 0.5s; }
        h1 span:nth-child(7) { animation-delay: 0.6s; }
        h1 span:nth-child(8) { animation-delay: 0.7s; }
        h1 span:nth-child(9) { animation-delay: 0.8s; }

        @keyframes letterShift {
            0%, 100% { transform: translateY(0px); }
            25% { transform: translateY(-3px); }
            50% { transform: translateY(0px); }
            75% { transform: translateY(2px); }
        }

        .theme-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            padding: 0.75rem 1.5rem 1rem;
            margin: 0 auto 1rem;
            max-width: 600px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            text-align: center;
        }

        .theme-label {
            font-size: 0.7rem;
            color: #666666;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 0.5rem;
        }

        .theme-name {
            color: #1a1a1a;
            font-weight: 700;
            font-size: 1.3rem;
            letter-spacing: 1px;
            text-transform: uppercase;
            line-height: 1.3;
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-top: 0.5rem;
        }

        .stat {
            font-size: 0.8rem;
            color: var(--light-gray);
            letter-spacing: 1px;
        }

        .stat-value {
            color: var(--gold);
            font-weight: 500;
            margin-left: 0.3rem;
        }

        .instructions {
            background: rgba(212, 175, 55, 0.1);
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 8px;
            padding: 0.75rem;
            margin-bottom: 1rem;
            font-size: 0.85rem;
            line-height: 1.5;
            color: var(--off-white);
            text-align: center;
        }

        .game-content-centered {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1.5rem;
            flex: 1;
            max-width: 600px;
            margin: 0 auto;
            width: 100%;
            padding: 0 1rem;
        }

        .check-section {
            width: 100%;
            display: flex;
            justify-content: center;
            margin-top: 1rem;
        }

        .check-btn {
            font-size: 1.2rem;
            padding: 1rem 3rem;
            font-weight: 700;
            letter-spacing: 2px;
            background: var(--gold);
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
            transition: all 0.15s ease;
            border: none;
            color: var(--black);
            animation: buttonGlow 3s ease infinite;
        }

        @keyframes buttonGlow {
            0%, 100% { 
                box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
            }
            50% { 
                box-shadow: 0 4px 25px rgba(212, 175, 55, 0.6);
            }
        }

        .check-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(212, 175, 55, 0.5);
            background: var(--gold-light);
        }

        .check-btn:active {
            transform: translateY(0) scale(0.98);
            box-shadow: 0 2px 10px rgba(212, 175, 55, 0.4);
        }

        .check-btn.checking {
            animation: checkPulse 0.6s ease;
            pointer-events: none;
        }

        @keyframes checkPulse {
            0% { 
                transform: scale(1);
                box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
            }
            50% { 
                transform: scale(0.95);
                box-shadow: 0 0 25px rgba(212, 175, 55, 0.7);
            }
            100% { 
                transform: scale(1);
                box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
            }
        }

        .card {
            background: var(--dark-gray);
            border: 1px solid var(--mid-gray);
            border-radius: 4px;
            padding: 0.5rem 0.75rem;
            transition: all 0.2s ease, transform 0.15s ease;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            cursor: grab;
            user-select: none;
        }

        .card:active {
            cursor: grabbing;
        }

        .card:hover {
            border-color: var(--light-gray);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .card.dragging {
            opacity: 0.4;
            transform: scale(1.02);
            box-shadow: 0 8px 24px rgba(212, 175, 55, 0.4);
        }

        .card.drag-over {
            border-color: var(--gold);
            background: rgba(212, 175, 55, 0.1);
            transform: scale(1.01);
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.3);
        }

        .card-image {
            width: 45px;
            height: 45px;
            object-fit: cover;
            border-radius: 3px;
            flex-shrink: 0;
            background: var(--mid-gray);
        }

        .card-content {
            flex: 1;
            min-width: 0;
            text-align: center;
        }

        .card-name {
            font-size: 0.9rem;
            font-weight: 400;
            margin-bottom: 0.15rem;
            color: var(--white);
            line-height: 1.2;
        }

        .card-value {
            font-family: 'Archivo Black', sans-serif;
            font-size: 1.1rem;
            font-weight: 400;
            color: var(--gold);
            letter-spacing: 1px;
            line-height: 1.2;
        }

        .card-value.hidden {
            color: var(--light-gray);
            font-size: 0.85rem;
        }

        .stack-section {
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .stack-label {
            font-size: 0.9rem;
            color: var(--light-gray);
            text-transform: uppercase;
            letter-spacing: 1px;
            text-align: center;
            margin-bottom: 0.75rem;
        }

        .endpoint-label {
            font-size: 0.7rem;
            font-weight: 700;
            letter-spacing: 1.2px;
            text-transform: uppercase;
            padding: 0.5rem 1rem;
            background: rgba(212, 175, 55, 0.15);
            border: 1px solid var(--gold);
            color: var(--gold);
            text-align: center;
            width: 100%;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .endpoint-label.highest {
            border-radius: 6px 6px 0 0;
            border-bottom: none;
        }

        .endpoint-label.lowest {
            border-radius: 0 0 6px 6px;
            border-top: none;
        }

        @media (max-width: 600px) {
            .endpoint-label {
                font-size: 0.6rem;
                letter-spacing: 1px;
                padding: 0.4rem 0.5rem;
            }
        }

        .stack-container {
            width: 100%;
        }

        .stack {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            padding: 1rem;
            background: rgba(26, 26, 26, 0.5);
            border: 1px solid var(--mid-gray);
            border-radius: 0;
            position: relative;
            border-left: 1px solid var(--gold);
            border-right: 1px solid var(--gold);
        }

        .stack::before {
            content: '';
            position: absolute;
            top: 0;
            bottom: 0;
            left: 50%;
            width: 2px;
            background: linear-gradient(to bottom, 
                var(--gold) 0%, 
                var(--mid-gray) 10%, 
                var(--mid-gray) 90%, 
                var(--gold) 100%);
            transform: translateX(-50%);
            z-index: 0;
            opacity: 0.3;
        }

        .stack-card {
            width: 100%;
            position: relative;
            z-index: 1;
            transition: all 0.2s ease;
        }

        .stack-card.reveal-flash {
            animation: revealFlash 0.6s ease;
        }

        .stack-card.incorrect-subtle {
            animation: subtleShake 0.4s ease;
        }

        @keyframes revealFlash {
            0% { 
                background: var(--dark-gray);
                border-color: var(--mid-gray);
            }
            30% { 
                background: var(--gold);
                border-color: var(--gold-light);
                box-shadow: 0 0 30px rgba(212, 175, 55, 0.8);
            }
            100% { 
                background: var(--dark-gray);
                border-color: var(--mid-gray);
            }
        }

        @keyframes subtleShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-3px); }
            50% { transform: translateX(3px); }
            75% { transform: translateX(-2px); }
        }

        #message {
            min-height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .message {
            padding: 0.75rem;
            border-radius: 6px;
            font-size: 0.9rem;
            text-align: center;
        }

        .message.success {
            background: rgba(212, 175, 55, 0.2);
            border: 1px solid var(--gold);
            color: var(--gold-light);
        }

        .message.info {
            background: rgba(52, 152, 219, 0.2);
            border: 1px solid #3498db;
            color: #5dade2;
        }

        .message.error {
            background: rgba(255, 68, 68, 0.2);
            border: 1px solid var(--error);
            color: var(--error);
        }

        .game-over {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 2rem;
        }

        .game-over.hidden {
            display: none;
        }

        .game-over h2 {
            font-size: 2rem;
            color: var(--gold);
            margin-bottom: 1rem;
            text-align: center;
        }

        .final-score {
            font-size: 3rem;
            color: var(--gold);
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .game-over p {
            font-size: 1.1rem;
            color: var(--off-white);
            margin-bottom: 2rem;
            text-align: center;
        }

        .btn-group {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .btn {
            background: var(--gold);
            color: var(--black);
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn:hover {
            background: var(--gold-light);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(212, 175, 55, 0.4);
        }

        .btn.secondary {
            background: var(--mid-gray);
            color: var(--white);
        }

        .btn.secondary:hover {
            background: var(--light-gray);
        }

        .countdown {
            font-size: 1.5rem;
            color: var(--gold);
            margin: 1rem 0;
            font-family: 'Archivo Black', sans-serif;
        }

        .header-buttons {
            position: absolute;
            top: 0;
            right: 0;
            display: flex;
            gap: 0.5rem;
        }

        .calendar-btn {
            background: transparent;
            border: 1px solid var(--mid-gray);
            color: var(--light-gray);
            width: 32px;
            height: 32px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .calendar-btn:hover {
            border-color: var(--gold);
            color: var(--gold);
        }

        .debug-btn {
            position: fixed;
            bottom: 10px;
            right: 10px;
            background: rgba(26, 26, 26, 0.8);
            border: 1px solid var(--mid-gray);
            color: var(--mid-gray);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0.3;
            z-index: 999;
        }

        .debug-btn:hover {
            opacity: 1;
            border-color: var(--gold);
            color: var(--gold);
            transform: scale(1.1);
        }

        .calendar-view {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            z-index: 1000;
            padding: 2rem;
            overflow-y: auto;
        }

        .calendar-view.hidden {
            display: none;
        }

        .calendar-header {
            margin-bottom: 2rem;
        }

        .calendar-header h2 {
            font-size: 2rem;
            color: var(--gold);
            margin-bottom: 0.5rem;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.5rem;
            max-width: 600px;
        }

        .calendar-day {
            aspect-ratio: 1;
            background: var(--dark-gray);
            border: 1px solid var(--mid-gray);
            border-radius: 4px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
            position: relative;
        }

        .calendar-day.completed {
            background: rgba(212, 175, 55, 0.2);
            border-color: var(--gold);
        }

        .calendar-day.today {
            border: 2px solid var(--gold);
        }

        .calendar-day-number {
            font-weight: 600;
            color: var(--white);
        }

        .calendar-day-status {
            font-size: 1.2rem;
            margin-top: 0.25rem;
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: var(--gold);
            top: -10px;
            z-index: 9999;
            animation: confetti-fall linear forwards;
        }

        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        @keyframes toastSlide {
            from {
                transform: translateX(-50%) translateY(20px);
                opacity: 0;
            }
            to {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }
        }

        .hidden {
            display: none !important;
        }

        .stack-container::-webkit-scrollbar {
            width: 6px;
        }

        .stack-container::-webkit-scrollbar-track {
            background: var(--black);
        }

        .stack-container::-webkit-scrollbar-thumb {
            background: var(--mid-gray);
            border-radius: 3px;
        }

        .stack-container::-webkit-scrollbar-thumb:hover {
            background: var(--gold);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-buttons">
                <button class="calendar-btn" onclick="showCalendar()" title="View calendar">üìÖ</button>
                <button class="calendar-btn" onclick="showHelp()" title="How to play">‚ùì</button>
            </div>
            <h1><span>N</span><span>E</span><span>R</span><span>D</span><span>S</span><span>T</span><span>A</span><span>C</span><span>K</span></h1>
            <div class="theme-container">
                <div class="theme-label">TODAY'S THEME:</div>
                <div class="theme-name" id="themeName"></div>
            </div>
        </header>

        <div id="gameArea" class="game-area">
            <div class="game-content-centered">
                
                <div class="stack-section">
                    <div class="stack-label">The Stack - Drag to Reorder</div>
                    <div class="endpoint-label highest" id="highestLabel">HIGHEST</div>
                    <div class="stack-container">
                        <div class="stack" id="stack"></div>
                    </div>
                    <div class="endpoint-label lowest" id="lowestLabel">LOWEST</div>
                </div>
                
                <div class="check-section">
                    <button class="btn check-btn" id="checkBtn" onclick="checkOrder()">
                        <span id="checkBtnText">CHECK ORDER ‚úì</span>
                    </button>
                </div>
                
                <div id="message"></div>
            </div>
        </div>

        <!-- Completed Screen -->
        <div id="completedScreen" class="game-over hidden">
            <h2>üéâ Already Completed Today! üéâ</h2>
            <p>You've finished today's NERDSTACK challenge!</p>
            <div class="final-score" id="completedScore">0</div>
            <p id="completedMessage"></p>
            <div class="countdown" id="countdown"></div>
            <div class="btn-group">
                <button class="btn secondary" onclick="showCalendar()">View Calendar</button>
                <button class="btn secondary" onclick="location.reload()">Refresh</button>
            </div>
        </div>

        <!-- Game Over Modal -->
        <div id="gameOver" class="game-over hidden">
            <h2 id="gameOverTitle">Game Over!</h2>
            <p id="successMessage"></p>
            <div class="countdown" id="gameOverCountdown"></div>
            <div class="btn-group">
                <button class="btn" onclick="restartGame()">Try Again üîÑ</button>
                <button class="btn" onclick="shareResults()">Share Results üìã</button>
                <button class="btn secondary" onclick="showCalendar()">View Calendar üìÖ</button>
            </div>
        </div>

        <!-- Calendar View -->
        <div id="calendarView" class="calendar-view hidden">
            <div class="calendar-header">
                <h2>Your NERDSTACK Calendar</h2>
                <p style="color: var(--light-gray);">Last 30 days</p>
            </div>
            <div class="calendar-grid" id="calendarGrid"></div>
            <div style="margin-top: 2rem;">
                <button class="btn" onclick="hideCalendar()">Close</button>
            </div>
        </div>

        <!-- Help Modal -->
        <div id="helpModal" class="game-over hidden">
            <h2>How to Play NERDSTACK</h2>
            <div style="text-align: left; max-width: 500px; margin: 1rem auto; line-height: 1.8;">
                <p><strong>üéØ Goal:</strong> Arrange all 5 cards in the correct order from highest to lowest value.</p>
                
                <p><strong>üéÆ How to Play:</strong></p>
                <ul style="margin-left: 1.5rem;">
                    <li>Drag and drop cards to reorder them</li>
                    <li>Press the CHECK button when you think they're in the right order</li>
                    <li>Cards in correct positions will reveal their values! ‚ú®</li>
                    <li>Wrong positions get a subtle shake</li>
                    <li>You have 5 attempts to get them all right</li>
                </ul>
                
                <p><strong>üí° Tips:</strong></p>
                <ul style="margin-left: 1.5rem;">
                    <li>Once a card's value is revealed, it stays revealed even if you move it</li>
                    <li>Use revealed values as hints to place the remaining cards</li>
                    <li>A new themed challenge appears every day!</li>
                </ul>
            </div>
            <div style="margin-top: 2rem;">
                <button class="btn" onclick="hideHelp()">Got it!</button>
            </div>
        </div>

        <!-- Debug Calendar Modal -->
        <div id="debugCalendar" class="game-over hidden">
            <h2>üêõ Debug Calendar</h2>
            <p style="color: var(--light-gray); margin-bottom: 1rem;">Jump to any day to test themes</p>
            <div id="debugCalendarGrid" style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 0.5rem; max-width: 600px; margin: 0 auto;"></div>
            <div style="margin-top: 2rem; display: flex; gap: 1rem; justify-content: center;">
                <button class="btn" onclick="resetToToday()">Reset to Today</button>
                <button class="btn secondary" onclick="hideDebugCalendar()">Close</button>
            </div>
        </div>

        <!-- Debug Button -->
        <button class="debug-btn" onclick="showDebugCalendar()" title="Debug: Test future days">üêõ</button>
    </div>

    <script>
        // ===== CATEGORIES DATA =====
        const categories = [
            {
                theme: "Indie Games",
                metric: "Metacritic Score",
                colorScheme: { primary: "#d4af37", light: "#f4d03f" },
                items: [
                    { name: "Hades", value: 93 },
                    { name: "Celeste", value: 91 },
                    { name: "Stardew Valley", value: 89 },
                    { name: "Undertale", value: 92 },
                    { name: "Hollow Knight", value: 90 },
                    { name: "Dead Cells", value: 89 },
                    { name: "Cuphead", value: 88 },
                    { name: "The Binding of Isaac", value: 84 },
                    { name: "Terraria", value: 83 },
                    { name: "FTL", value: 84 }
                ]
            },
            {
                theme: "Board Games",
                metric: "BoardGameGeek Rank",
                colorScheme: { primary: "#3498db", light: "#5dade2" },
                items: [
                    { name: "Gloomhaven", value: 1 },
                    { name: "Pandemic Legacy", value: 2 },
                    { name: "Brass Birmingham", value: 3 },
                    { name: "Twilight Imperium", value: 4 },
                    { name: "Terraforming Mars", value: 5 },
                    { name: "Wingspan", value: 15 },
                    { name: "Ticket to Ride", value: 189 },
                    { name: "Carcassonne", value: 156 },
                    { name: "Catan", value: 234 },
                    { name: "Monopoly", value: 25432 }
                ]
            },
            {
                theme: "Book Series",
                metric: "Number of Books",
                colorScheme: { primary: "#8e44ad", light: "#a569bd" },
                items: [
                    { name: "Perry Mason", value: 82 },
                    { name: "Hardy Boys", value: 190 },
                    { name: "Nancy Drew", value: 175 },
                    { name: "Goosebumps", value: 62 },
                    { name: "Discworld", value: 41 },
                    { name: "The Saint", value: 50 },
                    { name: "Jack Reacher", value: 28 },
                    { name: "Wheel of Time", value: 14 },
                    { name: "A Song of Ice and Fire", value: 5 },
                    { name: "The Hobbit & LOTR", value: 4 }
                ]
            },
            {
                theme: "Prolific Authors",
                metric: "Books Published",
                colorScheme: { primary: "#16a085", light: "#48c9b0" },
                items: [
                    { name: "Isaac Asimov", value: 463 },
                    { name: "R.L. Stine", value: 300 },
                    { name: "Nora Roberts", value: 225 },
                    { name: "Danielle Steel", value: 190 },
                    { name: "James Patterson", value: 147 },
                    { name: "Agatha Christie", value: 66 },
                    { name: "Stephen King", value: 64 },
                    { name: "J.K. Rowling", value: 14 },
                    { name: "George R.R. Martin", value: 8 },
                    { name: "Harper Lee", value: 2 }
                ]
            },
            {
                theme: "Anime Series",
                metric: "Episode Count",
                colorScheme: { primary: "#e67e22", light: "#f39c12" },
                items: [
                    { name: "One Piece", value: 1100 },
                    { name: "Detective Conan", value: 1050 },
                    { name: "Naruto (Total)", value: 720 },
                    { name: "Dragon Ball (Total)", value: 639 },
                    { name: "Bleach", value: 366 },
                    { name: "Fairy Tail", value: 328 },
                    { name: "Attack on Titan", value: 87 },
                    { name: "Demon Slayer", value: 55 },
                    { name: "Death Note", value: 37 },
                    { name: "Cowboy Bebop", value: 26 }
                ]
            },
            {
                theme: "LEGO Themes",
                metric: "Number of Sets Released",
                colorScheme: { primary: "#f39c12", light: "#f4d03f" },
                items: [
                    { name: "City", value: 1100 },
                    { name: "Star Wars", value: 900 },
                    { name: "Creator", value: 750 },
                    { name: "Technic", value: 600 },
                    { name: "Ninjago", value: 500 },
                    { name: "Friends", value: 300 },
                    { name: "Marvel", value: 140 },
                    { name: "Harry Potter", value: 90 },
                    { name: "DC", value: 80 },
                    { name: "Architecture", value: 65 }
                ]
            },
            {
                theme: "Viral YouTube Videos",
                metric: "Views (Billions)",
                colorScheme: { primary: "#2ecc71", light: "#58d68d" },
                items: [
                    { name: "Baby Shark Dance", value: 14.6 },
                    { name: "Despacito", value: 8.3 },
                    { name: "Shape of You", value: 6.1 },
                    { name: "See You Again", value: 6.0 },
                    { name: "Uptown Funk", value: 4.9 },
                    { name: "Gangnam Style", value: 4.8 },
                    { name: "Phonics Song", value: 4.6 },
                    { name: "Roar", value: 3.9 },
                    { name: "Sorry", value: 3.6 },
                    { name: "Sugar", value: 3.5 }
                ]
            },
            {
                theme: "Magic: The Gathering Cards",
                metric: "Value (USD)",
                colorScheme: { primary: "#9b59b6", light: "#af7ac5" },
                items: [
                    { name: "Black Lotus (Alpha)", value: 500000 },
                    { name: "Ancestral Recall", value: 25000 },
                    { name: "Mox Sapphire", value: 18000 },
                    { name: "Time Walk", value: 12000 },
                    { name: "Mox Ruby", value: 10000 },
                    { name: "Mox Emerald", value: 9500 },
                    { name: "Timetwister", value: 8000 },
                    { name: "Tarmogoyf (Future)", value: 300 },
                    { name: "Dark Confidant", value: 120 },
                    { name: "Snapcaster Mage", value: 80 }
                ]
            },
            {
                theme: "Dinosaurs",
                metric: "Length (meters)",
                colorScheme: { primary: "#27ae60", light: "#52be80" },
                items: [
                    { name: "Argentinosaurus", value: 35 },
                    { name: "Diplodocus", value: 27 },
                    { name: "Brachiosaurus", value: 26 },
                    { name: "Apatosaurus", value: 23 },
                    { name: "T-Rex", value: 12 },
                    { name: "Triceratops", value: 9 },
                    { name: "Stegosaurus", value: 9 },
                    { name: "Allosaurus", value: 8.5 },
                    { name: "Velociraptor", value: 2 },
                    { name: "Compsognathus", value: 1 }
                ]
            },
            {
                theme: "Star Trek Series",
                metric: "Year Released",
                colorScheme: { primary: "#3498db", light: "#5dade2" },
                items: [
                    { name: "The Original Series", value: 1966 },
                    { name: "The Animated Series", value: 1973 },
                    { name: "The Next Generation", value: 1987 },
                    { name: "Deep Space Nine", value: 1993 },
                    { name: "Voyager", value: 1995 },
                    { name: "Enterprise", value: 2001 },
                    { name: "Discovery", value: 2017 },
                    { name: "Picard", value: 2020 },
                    { name: "Lower Decks", value: 2020 },
                    { name: "Strange New Worlds", value: 2022 }
                ]
            },
            {
                theme: "Sci-Fi TV Shows",
                metric: "Number of Episodes",
                colorScheme: { primary: "#8e44ad", light: "#a569bd" },
                items: [
                    { name: "Doctor Who (Classic)", value: 695 },
                    { name: "Stargate SG-1", value: 214 },
                    { name: "The X-Files", value: 218 },
                    { name: "Star Trek: TNG", value: 178 },
                    { name: "Supernatural", value: 327 },
                    { name: "Smallville", value: 217 },
                    { name: "Battlestar Galactica", value: 73 },
                    { name: "The Expanse", value: 62 },
                    { name: "Stranger Things", value: 42 },
                    { name: "Westworld", value: 36 }
                ]
            },
            {
                theme: "Doctor Who Doctors",
                metric: "Order of Appearance",
                colorScheme: { primary: "#e74c3c", light: "#ec7063" },
                items: [
                    { name: "William Hartnell (First)", value: 1 },
                    { name: "Patrick Troughton (Second)", value: 2 },
                    { name: "Jon Pertwee (Third)", value: 3 },
                    { name: "Tom Baker (Fourth)", value: 4 },
                    { name: "Peter Davison (Fifth)", value: 5 },
                    { name: "Colin Baker (Sixth)", value: 6 },
                    { name: "Sylvester McCoy (Seventh)", value: 7 },
                    { name: "Paul McGann (Eighth)", value: 8 },
                    { name: "Christopher Eccleston (Ninth)", value: 9 },
                    { name: "David Tennant (Tenth)", value: 10 }
                ]
            },
            {
                theme: "Horror Movies",
                metric: "Year Released",
                colorScheme: { primary: "#c0392b", light: "#e74c3c" },
                items: [
                    { name: "Nosferatu", value: 1922 },
                    { name: "Psycho", value: 1960 },
                    { name: "The Exorcist", value: 1973 },
                    { name: "Halloween", value: 1978 },
                    { name: "The Shining", value: 1980 },
                    { name: "A Nightmare on Elm Street", value: 1984 },
                    { name: "The Silence of the Lambs", value: 1991 },
                    { name: "The Ring", value: 2002 },
                    { name: "Get Out", value: 2017 },
                    { name: "Hereditary", value: 2018 }
                ]
            },
            {
                theme: "Fantasy Movies",
                metric: "Box Office (Million USD)",
                colorScheme: { primary: "#9b59b6", light: "#af7ac5" },
                items: [
                    { name: "The Lord of the Rings: Return of the King", value: 1142 },
                    { name: "Harry Potter and the Deathly Hallows Pt 2", value: 1342 },
                    { name: "The Hobbit: An Unexpected Journey", value: 1017 },
                    { name: "Alice in Wonderland (2010)", value: 1025 },
                    { name: "The Chronicles of Narnia: The Lion", value: 745 },
                    { name: "Maleficent", value: 758 },
                    { name: "Beauty and the Beast (2017)", value: 1264 },
                    { name: "Aladdin (2019)", value: 1051 },
                    { name: "Fantastic Beasts", value: 814 },
                    { name: "Pan's Labyrinth", value: 83 }
                ]
            },
            {
                theme: "Space Adventure Movies",
                metric: "Year Released",
                colorScheme: { primary: "#34495e", light: "#5d6d7e" },
                items: [
                    { name: "2001: A Space Odyssey", value: 1968 },
                    { name: "Star Wars", value: 1977 },
                    { name: "Alien", value: 1979 },
                    { name: "E.T.", value: 1982 },
                    { name: "The Fifth Element", value: 1997 },
                    { name: "Galaxy Quest", value: 1999 },
                    { name: "WALL-E", value: 2008 },
                    { name: "Avatar", value: 2009 },
                    { name: "Gravity", value: 2013 },
                    { name: "Interstellar", value: 2014 }
                ]
            },
            {
                theme: "Marvel Cinematic Universe",
                metric: "Box Office (Million USD)",
                colorScheme: { primary: "#c0392b", light: "#e74c3c" },
                items: [
                    { name: "Avengers: Endgame", value: 2798 },
                    { name: "Avengers: Infinity War", value: 2048 },
                    { name: "Spider-Man: No Way Home", value: 1921 },
                    { name: "The Avengers", value: 1519 },
                    { name: "Avengers: Age of Ultron", value: 1403 },
                    { name: "Black Panther", value: 1347 },
                    { name: "Iron Man 3", value: 1215 },
                    { name: "Captain America: Civil War", value: 1153 },
                    { name: "Captain Marvel", value: 1128 },
                    { name: "Spider-Man: Homecoming", value: 880 }
                ]
            },
            {
                theme: "DC Movies",
                metric: "Box Office (Million USD)",
                colorScheme: { primary: "#2c3e50", light: "#34495e" },
                items: [
                    { name: "Aquaman", value: 1148 },
                    { name: "The Dark Knight Rises", value: 1081 },
                    { name: "The Dark Knight", value: 1005 },
                    { name: "Joker", value: 1074 },
                    { name: "Batman v Superman", value: 874 },
                    { name: "Suicide Squad", value: 746 },
                    { name: "Wonder Woman", value: 822 },
                    { name: "The Batman", value: 771 },
                    { name: "Man of Steel", value: 668 },
                    { name: "Shazam!", value: 366 }
                ]
            },
            {
                theme: "Pre-MCU Marvel Movies",
                metric: "Year Released",
                colorScheme: { primary: "#e67e22", light: "#f39c12" },
                items: [
                    { name: "Howard the Duck", value: 1986 },
                    { name: "Blade", value: 1998 },
                    { name: "X-Men", value: 2000 },
                    { name: "Spider-Man (Raimi)", value: 2002 },
                    { name: "Daredevil", value: 2003 },
                    { name: "Hulk", value: 2003 },
                    { name: "Fantastic Four", value: 2005 },
                    { name: "Ghost Rider", value: 2007 },
                    { name: "Iron Man", value: 2008 },
                    { name: "The Incredible Hulk", value: 2008 }
                ]
            },
            {
                theme: "Prolific Authors",
                metric: "Books Published",
                colorScheme: { primary: "#16a085", light: "#48c9b0" },
                items: [
                    { name: "Isaac Asimov", value: 463 },
                    { name: "R.L. Stine", value: 300 },
                    { name: "Nora Roberts", value: 225 },
                    { name: "Danielle Steel", value: 190 },
                    { name: "James Patterson", value: 147 },
                    { name: "Agatha Christie", value: 66 },
                    { name: "Stephen King", value: 64 },
                    { name: "J.K. Rowling", value: 14 },
                    { name: "George R.R. Martin", value: 8 },
                    { name: "Harper Lee", value: 2 }
                ]
            },
            {
                theme: "Anime Series",
                metric: "Episode Count",
                colorScheme: { primary: "#e67e22", light: "#f39c12" },
                items: [
                    { name: "One Piece", value: 1100 },
                    { name: "Detective Conan", value: 1050 },
                    { name: "Naruto (Total)", value: 720 },
                    { name: "Dragon Ball (Total)", value: 639 },
                    { name: "Bleach", value: 366 },
                    { name: "Fairy Tail", value: 328 },
                    { name: "Attack on Titan", value: 87 },
                    { name: "Demon Slayer", value: 55 },
                    { name: "Death Note", value: 37 },
                    { name: "Cowboy Bebop", value: 26 }
                ]
            },
            {
                theme: "LEGO Themes",
                metric: "Number of Sets Released",
                colorScheme: { primary: "#f39c12", light: "#f4d03f" },
                items: [
                    { name: "City", value: 1100 },
                    { name: "Star Wars", value: 900 },
                    { name: "Creator", value: 750 },
                    { name: "Technic", value: 600 },
                    { name: "Ninjago", value: 500 },
                    { name: "Friends", value: 300 },
                    { name: "Marvel", value: 140 },
                    { name: "Harry Potter", value: 90 },
                    { name: "DC", value: 80 },
                    { name: "Architecture", value: 65 }
                ]
            },
            {
                theme: "Viral YouTube Videos",
                metric: "Views (Billions)",
                colorScheme: { primary: "#2ecc71", light: "#58d68d" },
                items: [
                    { name: "Baby Shark Dance", value: 14.6 },
                    { name: "Despacito", value: 8.3 },
                    { name: "Shape of You", value: 6.1 },
                    { name: "See You Again", value: 6.0 },
                    { name: "Uptown Funk", value: 4.9 },
                    { name: "Gangnam Style", value: 4.8 },
                    { name: "Phonics Song", value: 4.6 },
                    { name: "Roar", value: 3.9 },
                    { name: "Sorry", value: 3.6 },
                    { name: "Sugar", value: 3.5 }
                ]
            },
            {
                theme: "Magic: The Gathering Cards",
                metric: "Value (USD)",
                colorScheme: { primary: "#9b59b6", light: "#af7ac5" },
                items: [
                    { name: "Black Lotus (Alpha)", value: 500000 },
                    { name: "Ancestral Recall", value: 25000 },
                    { name: "Mox Sapphire", value: 18000 },
                    { name: "Time Walk", value: 12000 },
                    { name: "Mox Ruby", value: 10000 },
                    { name: "Mox Emerald", value: 9500 },
                    { name: "Timetwister", value: 8000 },
                    { name: "Tarmogoyf (Future)", value: 300 },
                    { name: "Dark Confidant", value: 120 },
                    { name: "Snapcaster Mage", value: 80 }
                ]
            },
            {
                theme: "Dinosaurs",
                metric: "Length (meters)",
                colorScheme: { primary: "#27ae60", light: "#52be80" },
                items: [
                    { name: "Argentinosaurus", value: 35 },
                    { name: "Diplodocus", value: 27 },
                    { name: "Brachiosaurus", value: 26 },
                    { name: "Apatosaurus", value: 23 },
                    { name: "T-Rex", value: 12 },
                    { name: "Triceratops", value: 9 },
                    { name: "Stegosaurus", value: 9 },
                    { name: "Allosaurus", value: 8.5 },
                    { name: "Velociraptor", value: 2 },
                    { name: "Compsognathus", value: 1 }
                ]
            },
            {
                theme: "Star Trek Series",
                metric: "Year Released",
                colorScheme: { primary: "#3498db", light: "#5dade2" },
                items: [
                    { name: "The Original Series", value: 1966 },
                    { name: "The Animated Series", value: 1973 },
                    { name: "The Next Generation", value: 1987 },
                    { name: "Deep Space Nine", value: 1993 },
                    { name: "Voyager", value: 1995 },
                    { name: "Enterprise", value: 2001 },
                    { name: "Discovery", value: 2017 },
                    { name: "Picard", value: 2020 },
                    { name: "Lower Decks", value: 2020 },
                    { name: "Strange New Worlds", value: 2022 }
                ]
            },
            {
                theme: "Sci-Fi TV Shows",
                metric: "Number of Episodes",
                colorScheme: { primary: "#8e44ad", light: "#a569bd" },
                items: [
                    { name: "Doctor Who (Classic)", value: 695 },
                    { name: "Stargate SG-1", value: 214 },
                    { name: "The X-Files", value: 218 },
                    { name: "Star Trek: TNG", value: 178 },
                    { name: "Supernatural", value: 327 },
                    { name: "Smallville", value: 217 },
                    { name: "Battlestar Galactica", value: 73 },
                    { name: "The Expanse", value: 62 },
                    { name: "Stranger Things", value: 42 },
                    { name: "Westworld", value: 36 }
                ]
            },
            {
                theme: "Doctor Who Doctors",
                metric: "Order of Appearance",
                colorScheme: { primary: "#e74c3c", light: "#ec7063" },
                items: [
                    { name: "William Hartnell (First)", value: 1 },
                    { name: "Patrick Troughton (Second)", value: 2 },
                    { name: "Jon Pertwee (Third)", value: 3 },
                    { name: "Tom Baker (Fourth)", value: 4 },
                    { name: "Peter Davison (Fifth)", value: 5 },
                    { name: "Colin Baker (Sixth)", value: 6 },
                    { name: "Sylvester McCoy (Seventh)", value: 7 },
                    { name: "Paul McGann (Eighth)", value: 8 },
                    { name: "Christopher Eccleston (Ninth)", value: 9 },
                    { name: "David Tennant (Tenth)", value: 10 }
                ]
            },
            {
                theme: "Horror Movies",
                metric: "Year Released",
                colorScheme: { primary: "#c0392b", light: "#e74c3c" },
                items: [
                    { name: "Nosferatu", value: 1922 },
                    { name: "Psycho", value: 1960 },
                    { name: "The Exorcist", value: 1973 },
                    { name: "Halloween", value: 1978 },
                    { name: "The Shining", value: 1980 },
                    { name: "A Nightmare on Elm Street", value: 1984 },
                    { name: "The Silence of the Lambs", value: 1991 },
                    { name: "The Ring", value: 2002 },
                    { name: "Get Out", value: 2017 },
                    { name: "Hereditary", value: 2018 }
                ]
            },
            {
                theme: "Fantasy Movies",
                metric: "Box Office (Million USD)",
                colorScheme: { primary: "#9b59b6", light: "#af7ac5" },
                items: [
                    { name: "Harry Potter: Deathly Hallows 2", value: 1342 },
                    { name: "Beauty and the Beast (2017)", value: 1264 },
                    { name: "LOTR: Return of the King", value: 1142 },
                    { name: "Aladdin (2019)", value: 1051 },
                    { name: "Alice in Wonderland (2010)", value: 1025 },
                    { name: "The Hobbit", value: 1017 },
                    { name: "Fantastic Beasts", value: 814 },
                    { name: "Maleficent", value: 758 },
                    { name: "Narnia: The Lion", value: 745 },
                    { name: "Pan's Labyrinth", value: 83 }
                ]
            },
            {
                theme: "Space Adventure Movies",
                metric: "Year Released",
                colorScheme: { primary: "#34495e", light: "#5d6d7e" },
                items: [
                    { name: "2001: A Space Odyssey", value: 1968 },
                    { name: "Star Wars", value: 1977 },
                    { name: "Alien", value: 1979 },
                    { name: "E.T.", value: 1982 },
                    { name: "The Fifth Element", value: 1997 },
                    { name: "Galaxy Quest", value: 1999 },
                    { name: "WALL-E", value: 2008 },
                    { name: "Avatar", value: 2009 },
                    { name: "Gravity", value: 2013 },
                    { name: "Interstellar", value: 2014 }
                ]
            },
            {
                theme: "Marvel Cinematic Universe",
                metric: "Box Office (Million USD)",
                colorScheme: { primary: "#c0392b", light: "#e74c3c" },
                items: [
                    { name: "Avengers: Endgame", value: 2798 },
                    { name: "Avengers: Infinity War", value: 2048 },
                    { name: "Spider-Man: No Way Home", value: 1921 },
                    { name: "The Avengers", value: 1519 },
                    { name: "Avengers: Age of Ultron", value: 1403 },
                    { name: "Black Panther", value: 1347 },
                    { name: "Iron Man 3", value: 1215 },
                    { name: "Captain America: Civil War", value: 1153 },
                    { name: "Captain Marvel", value: 1128 },
                    { name: "Spider-Man: Homecoming", value: 880 }
                ]
            },
            {
                theme: "DC Movies",
                metric: "Box Office (Million USD)",
                colorScheme: { primary: "#2c3e50", light: "#34495e" },
                items: [
                    { name: "Aquaman", value: 1148 },
                    { name: "The Dark Knight Rises", value: 1081 },
                    { name: "Joker", value: 1074 },
                    { name: "The Dark Knight", value: 1005 },
                    { name: "Batman v Superman", value: 874 },
                    { name: "Wonder Woman", value: 822 },
                    { name: "The Batman", value: 771 },
                    { name: "Suicide Squad", value: 746 },
                    { name: "Man of Steel", value: 668 },
                    { name: "Shazam!", value: 366 }
                ]
            },
            {
                theme: "Video Game Franchises",
                metric: "Total Sales (Millions)",
                colorScheme: { primary: "#e74c3c", light: "#ec7063" },
                items: [
                    { name: "Mario", value: 832 },
                    { name: "Pok√©mon", value: 480 },
                    { name: "Call of Duty", value: 425 },
                    { name: "Grand Theft Auto", value: 405 },
                    { name: "FIFA", value: 325 },
                    { name: "The Sims", value: 200 },
                    { name: "Tetris", value: 170 },
                    { name: "Minecraft", value: 238 },
                    { name: "Zelda", value: 130 },
                    { name: "Sonic", value: 89 }
                ]
            },
            {
                theme: "Best-Selling Video Games",
                metric: "Copies Sold (Millions)",
                colorScheme: { primary: "#9b59b6", light: "#af7ac5" },
                items: [
                    { name: "Minecraft", value: 238 },
                    { name: "GTA V", value: 185 },
                    { name: "Tetris (EA)", value: 100 },
                    { name: "Wii Sports", value: 83 },
                    { name: "PUBG", value: 75 },
                    { name: "Mario Kart 8", value: 62 },
                    { name: "Super Mario Bros", value: 58 },
                    { name: "Red Dead Redemption 2", value: 50 },
                    { name: "Pok√©mon Red/Blue", value: 47 },
                    { name: "Terraria", value: 44 }
                ]
            },
            {
                theme: "Game of the Year Winners",
                metric: "Year Won",
                colorScheme: { primary: "#f39c12", light: "#f4d03f" },
                items: [
                    { name: "The Last of Us Part II", value: 2020 },
                    { name: "Sekiro", value: 2019 },
                    { name: "God of War", value: 2018 },
                    { name: "Zelda: Breath of the Wild", value: 2017 },
                    { name: "Overwatch", value: 2016 },
                    { name: "The Witcher 3", value: 2015 },
                    { name: "Dragon Age Inquisition", value: 2014 },
                    { name: "The Last of Us", value: 2013 },
                    { name: "The Walking Dead", value: 2012 },
                    { name: "Skyrim", value: 2011 }
                ]
            },
            {
                theme: "Nintendo Console Sales",
                metric: "Units Sold (Millions)",
                colorScheme: { primary: "#e74c3c", light: "#ec7063" },
                items: [
                    { name: "Nintendo DS", value: 154 },
                    { name: "Game Boy/Color", value: 119 },
                    { name: "Nintendo Switch", value: 132 },
                    { name: "Wii", value: 102 },
                    { name: "Game Boy Advance", value: 82 },
                    { name: "3DS", value: 76 },
                    { name: "NES", value: 62 },
                    { name: "SNES", value: 49 },
                    { name: "N64", value: 33 },
                    { name: "GameCube", value: 22 }
                ]
            },
            {
                theme: "PlayStation Exclusives",
                metric: "Metacritic Score",
                colorScheme: { primary: "#3498db", light: "#5dade2" },
                items: [
                    { name: "The Last of Us", value: 95 },
                    { name: "God of War (2018)", value: 94 },
                    { name: "Uncharted 2", value: 96 },
                    { name: "Bloodborne", value: 92 },
                    { name: "Spider-Man", value: 87 },
                    { name: "Horizon Zero Dawn", value: 89 },
                    { name: "Ghost of Tsushima", value: 83 },
                    { name: "Ratchet & Clank", value: 85 },
                    { name: "Gran Turismo 7", value: 87 },
                    { name: "Returnal", value: 86 }
                ]
            },
            {
                theme: "Spiel des Jahres Winners",
                metric: "Year Won",
                colorScheme: { primary: "#e67e22", light: "#f39c12" },
                items: [
                    { name: "Dorfromantik", value: 2023 },
                    { name: "Cascadia", value: 2022 },
                    { name: "MicroMacro: Crime City", value: 2021 },
                    { name: "Pictures", value: 2020 },
                    { name: "Just One", value: 2019 },
                    { name: "Azul", value: 2018 },
                    { name: "Kingdomino", value: 2017 },
                    { name: "Codenames", value: 2016 },
                    { name: "Colt Express", value: 2015 },
                    { name: "Camel Up", value: 2014 }
                ]
            },
            {
                theme: "Android Versions",
                metric: "Year Released",
                colorScheme: { primary: "#27ae60", light: "#52be80" },
                items: [
                    { name: "Android 14", value: 2023 },
                    { name: "Android 13 (Tiramisu)", value: 2022 },
                    { name: "Android 12 (Snow Cone)", value: 2021 },
                    { name: "Android 11", value: 2020 },
                    { name: "Android 10 (Q)", value: 2019 },
                    { name: "Android 9 (Pie)", value: 2018 },
                    { name: "Android 8 (Oreo)", value: 2017 },
                    { name: "Android 7 (Nougat)", value: 2016 },
                    { name: "Android 6 (Marshmallow)", value: 2015 },
                    { name: "Android 5 (Lollipop)", value: 2014 }
                ]
            },
            {
                theme: "macOS Versions",
                metric: "Year Released",
                colorScheme: { primary: "#95a5a6", light: "#bdc3c7" },
                items: [
                    { name: "macOS Sonoma", value: 2023 },
                    { name: "macOS Ventura", value: 2022 },
                    { name: "macOS Monterey", value: 2021 },
                    { name: "macOS Big Sur", value: 2020 },
                    { name: "macOS Catalina", value: 2019 },
                    { name: "macOS Mojave", value: 2018 },
                    { name: "macOS High Sierra", value: 2017 },
                    { name: "macOS Sierra", value: 2016 },
                    { name: "OS X El Capitan", value: 2015 },
                    { name: "OS X Yosemite", value: 2014 }
                ]
            },
            {
                theme: "Tech Inventions",
                metric: "Year Invented",
                colorScheme: { primary: "#34495e", light: "#5d6d7e" },
                items: [
                    { name: "iPhone", value: 2007 },
                    { name: "iPod", value: 2001 },
                    { name: "Google Search", value: 1998 },
                    { name: "DVD", value: 1996 },
                    { name: "World Wide Web", value: 1991 },
                    { name: "CD", value: 1982 },
                    { name: "VHS", value: 1976 },
                    { name: "Email", value: 1971 },
                    { name: "Computer Mouse", value: 1964 },
                    { name: "FORTRAN", value: 1957 }
                ]
            },
            {
                theme: "Tech Products Sales",
                metric: "Units Sold (Millions)",
                colorScheme: { primary: "#2ecc71", light: "#58d68d" },
                items: [
                    { name: "iPhone (all time)", value: 2300 },
                    { name: "PlayStation 2", value: 155 },
                    { name: "Nintendo DS", value: 154 },
                    { name: "Game Boy", value: 119 },
                    { name: "PlayStation 4", value: 117 },
                    { name: "iPad (all time)", value: 500 },
                    { name: "Wii", value: 102 },
                    { name: "PlayStation", value: 102 },
                    { name: "PlayStation 3", value: 87 },
                    { name: "Xbox 360", value: 84 }
                ]
            }
        ];

        // Special day categories
        const specialDayCategories = {
            // April Fools
            "04-01": {
                theme: "Most Common Fish",
                metric: "Population (Billions)",
                colorScheme: { primary: "#3498db", light: "#5dade2" },
                items: [
                    { name: "Bristlemouth Fish", value: 1000 },
                    { name: "Cyclothone", value: 500 },
                    { name: "Herring", value: 3 },
                    { name: "Anchovies", value: 2.5 },
                    { name: "Sardines", value: 2 },
                    { name: "Goldfish (wild)", value: 0.5 },
                    { name: "Tuna", value: 0.3 },
                    { name: "Salmon", value: 0.2 },
                    { name: "Mackerel", value: 0.15 },
                    { name: "Cod", value: 0.1 }
                ]
            },
            // September 21st - Famous Women Actors
            "09-21": {
                theme: "Famous Women Actors",
                metric: "Year of Birth",
                colorScheme: { primary: "#e74c3c", light: "#ec7063" },
                items: [
                    { name: "Zendaya", value: 1996 },
                    { name: "Emma Stone", value: 1988 },
                    { name: "Scarlett Johansson", value: 1984 },
                    { name: "Natalie Portman", value: 1981 },
                    { name: "Kate Winslet", value: 1975 },
                    { name: "Angelina Jolie", value: 1975 },
                    { name: "Sandra Bullock", value: 1964 },
                    { name: "Julia Roberts", value: 1967 },
                    { name: "Meryl Streep", value: 1949 },
                    { name: "Judi Dench", value: 1934 }
                ]
            },
            // ALL OF OCTOBER - Halloween themed!
            "10-01": {
                theme: "Classic Movie Monsters",
                metric: "First Film Appearance",
                colorScheme: { primary: "#8e44ad", light: "#9b59b6" },
                items: [
                    { name: "Pennywise", value: 1990 },
                    { name: "Xenomorph (Alien)", value: 1979 },
                    { name: "Jaws Shark", value: 1975 },
                    { name: "The Exorcist Demon", value: 1973 },
                    { name: "King Kong", value: 1933 },
                    { name: "Frankenstein's Monster", value: 1931 },
                    { name: "Dracula", value: 1931 },
                    { name: "The Mummy", value: 1932 },
                    { name: "The Phantom", value: 1925 },
                    { name: "Nosferatu", value: 1922 }
                ]
            },
            "10-02": {
                theme: "Horror Movie Villains",
                metric: "Kill Count in Films",
                colorScheme: { primary: "#c0392b", light: "#e74c3c" },
                items: [
                    { name: "Jason Voorhees", value: 157 },
                    { name: "Michael Myers", value: 140 },
                    { name: "Freddy Krueger", value: 42 },
                    { name: "Chucky", value: 38 },
                    { name: "Ghostface", value: 52 },
                    { name: "Jigsaw", value: 60 },
                    { name: "Leatherface", value: 31 },
                    { name: "Pennywise", value: 27 },
                    { name: "Pinhead", value: 35 },
                    { name: "Hannibal Lecter", value: 12 }
                ]
            },
            "10-03": {
                theme: "Mythological Creatures",
                metric: "First Written Record (Year)",
                colorScheme: { primary: "#16a085", light: "#48c9b0" },
                items: [
                    { name: "Mothman", value: 1966 },
                    { name: "Jersey Devil", value: 1735 },
                    { name: "Kraken", value: 1180 },
                    { name: "Basilisk", value: 79 },
                    { name: "Phoenix", value: -500 },
                    { name: "Chimera", value: -700 },
                    { name: "Minotaur", value: -800 },
                    { name: "Medusa", value: -800 },
                    { name: "Cyclops", value: -850 },
                    { name: "Dragon", value: -2000 }
                ]
            },
            "10-04": {
                theme: "Famous Witches",
                metric: "Year First Appeared",
                colorScheme: { primary: "#8e44ad", light: "#a569bd" },
                items: [
                    { name: "Hermione Granger", value: 1997 },
                    { name: "Sabrina Spellman", value: 1996 },
                    { name: "The Craft Witches", value: 1996 },
                    { name: "Ursula", value: 1989 },
                    { name: "Hocus Pocus Sisters", value: 1993 },
                    { name: "Wicked Witch of West", value: 1939 },
                    { name: "Maleficent", value: 1959 },
                    { name: "Glinda", value: 1900 },
                    { name: "Morgan le Fay", value: 1150 },
                    { name: "Circe", value: -800 }
                ]
            },
            "10-05": {
                theme: "Haunted House Movies",
                metric: "Release Year",
                colorScheme: { primary: "#34495e", light: "#5d6d7e" },
                items: [
                    { name: "The Conjuring", value: 2013 },
                    { name: "Insidious", value: 2010 },
                    { name: "Paranormal Activity", value: 2007 },
                    { name: "The Others", value: 2001 },
                    { name: "The Sixth Sense", value: 1999 },
                    { name: "The Haunting", value: 1999 },
                    { name: "Poltergeist", value: 1982 },
                    { name: "The Amityville Horror", value: 1979 },
                    { name: "The Exorcist", value: 1973 },
                    { name: "The Haunting", value: 1963 }
                ]
            },
            "10-30": {
                theme: "Popular Candy",
                metric: "Sugar per 100g",
                colorScheme: { primary: "#e67e22", light: "#f39c12" },
                items: [
                    { name: "Skittles", value: 91 },
                    { name: "Sour Patch Kids", value: 82 },
                    { name: "Jolly Ranchers", value: 80 },
                    { name: "Starburst", value: 78 },
                    { name: "Twizzlers", value: 66 },
                    { name: "M&M's", value: 68 },
                    { name: "Reese's Cups", value: 52 },
                    { name: "Kit Kat", value: 54 },
                    { name: "Snickers", value: 50 },
                    { name: "Milky Way", value: 60 }
                ]
            },
            "10-31": {
                theme: "Halloween Costumes",
                metric: "Year Most Popular",
                colorScheme: { primary: "#8e44ad", light: "#9b59b6" },
                items: [
                    { name: "Ghost", value: 1950 },
                    { name: "Witch", value: 1960 },
                    { name: "Vampire", value: 1970 },
                    { name: "Princess", value: 1980 },
                    { name: "Ninja", value: 1985 },
                    { name: "Pirate", value: 1995 },
                    { name: "Spider-Man", value: 2002 },
                    { name: "Batman", value: 2008 },
                    { name: "Elsa (Frozen)", value: 2014 },
                    { name: "Among Us Crewmate", value: 2020 }
                ]
            },
            // Christmas Days
            "12-01": {
                theme: "Christmas Movies",
                metric: "Release Year",
                colorScheme: { primary: "#27ae60", light: "#52be80" },
                items: [
                    { name: "It's a Wonderful Life", value: 1946 },
                    { name: "Miracle on 34th Street", value: 1947 },
                    { name: "White Christmas", value: 1954 },
                    { name: "A Christmas Story", value: 1983 },
                    { name: "National Lampoon's Christmas Vacation", value: 1989 },
                    { name: "Home Alone", value: 1990 },
                    { name: "The Nightmare Before Christmas", value: 1993 },
                    { name: "Elf", value: 2003 },
                    { name: "The Polar Express", value: 2004 },
                    { name: "Klaus", value: 2019 }
                ]
            },
            "12-02": {
                theme: "Best-Selling Toys",
                metric: "Year Became Best-Seller",
                colorScheme: { primary: "#3498db", light: "#5dade2" },
                items: [
                    { name: "Hula Hoop", value: 1958 },
                    { name: "Barbie", value: 1959 },
                    { name: "G.I. Joe", value: 1964 },
                    { name: "Hot Wheels", value: 1968 },
                    { name: "Star Wars Figures", value: 1978 },
                    { name: "Rubik's Cube", value: 1980 },
                    { name: "Cabbage Patch Kids", value: 1983 },
                    { name: "Tickle Me Elmo", value: 1996 },
                    { name: "Furby", value: 1998 },
                    { name: "Baby Yoda Plush", value: 2020 }
                ]
            }
        };

        // ===== DAILY CHALLENGE SYSTEM =====
        
        // Seeded random
        function seededRandom(seed) {
            let x = Math.sin(seed++) * 10000;
            return x - Math.floor(x);
        }

        // Get today's seed
        // Get date key
        function getDateKey(date = new Date()) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        // Check if completed
        function isTodayCompleted() {
            return localStorage.getItem(`nerdstack_completed_${getDateKey()}`) === 'true';
        }

        // Mark completed
        function markTodayCompleted() {
            const key = getDateKey();
            localStorage.setItem(`nerdstack_completed_${key}`, 'true');
        }

        // Get today's category
        function getTodaysCategory() {
            const today = debugDate || new Date();
            const monthDay = `${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;
            
            if (specialDayCategories[monthDay]) {
                return specialDayCategories[monthDay];
            }
            
            const seed = getTodaysSeed();
            const index = Math.floor(seededRandom(seed) * categories.length);
            return categories[index];
        }

        // Seeded shuffle
        function seededShuffle(array, seed) {
            const arr = [...array];
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(seededRandom(seed + i) * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        // Get today's cards
        function getTodaysCards(category) {
            const seed = getTodaysSeed();
            const shuffled = seededShuffle(category.items, seed);
            return shuffled.slice(0, 5);
        }

        // Time until next puzzle
        function getTimeUntilNextPuzzle() {
            const now = new Date();
            const tomorrow = new Date(now);
            tomorrow.setDate(tomorrow.getDate() + 1);
            tomorrow.setHours(0, 0, 0, 0);
            
            const diff = tomorrow - now;
            const hours = Math.floor(diff / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);
            
            return { hours, minutes, seconds };
        }

        // Update countdown
        function updateCountdown(elementId) {
            const el = document.getElementById(elementId);
            if (!el) return;
            
            const time = getTimeUntilNextPuzzle();
            el.textContent = `Next puzzle in: ${String(time.hours).padStart(2, '0')}:${String(time.minutes).padStart(2, '0')}:${String(time.seconds).padStart(2, '0')}`;
        }

        // Share results
        function shareResults() {
            const dateKey = getDateKey();
            const isWin = revealedCards.size === 5;
            const result = isWin ? 
                `‚úÖ Completed in ${checks} ${checks === 1 ? 'check' : 'checks'}!` : 
                `‚ùå Out of lives (${checks} ${checks === 1 ? 'check' : 'checks'})`;
            
            // Get theme name (combined theme + metric)
            const themeName = `${currentCategory.theme} ${currentCategory.metric}`.toUpperCase();
            
            const text = `NERDSTACK ${dateKey}
${themeName}
${result}

Play daily at: nerdstack.game`;
            
            navigator.clipboard.writeText(text).then(() => {
                showToast('‚úì Results copied to clipboard!');
            }).catch(() => {
                showToast('‚ùå Failed to copy');
            });
        }

        function showToast(message) {
            // Create toast element
            const toast = document.createElement('div');
            toast.textContent = message;
            toast.style.cssText = `
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: var(--gold);
                color: var(--black);
                padding: 1rem 2rem;
                border-radius: 8px;
                font-weight: 600;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
                z-index: 10000;
                animation: toastSlide 0.3s ease;
            `;
            
            document.body.appendChild(toast);
            
            // Remove after 2 seconds
            setTimeout(() => {
                toast.style.animation = 'toastSlide 0.3s ease reverse';
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 300);
            }, 2000);
        }

        // Get calendar data
        function getCalendarData() {
            const calendar = [];
            const today = new Date();
            
            for (let i = 29; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                const dateKey = getDateKey(date);
                
                const completed = localStorage.getItem(`nerdstack_completed_${dateKey}`) === 'true';
                const score = localStorage.getItem(`nerdstack_score_${dateKey}`);
                
                calendar.push({
                    date: dateKey,
                    completed,
                    score: score ? parseInt(score) : null,
                    isToday: dateKey === getDateKey(today),
                    dayNumber: date.getDate()
                });
            }
            
            return calendar;
        }

        // Show calendar
        function showCalendar() {
            const calendar = getCalendarData();
            const grid = document.getElementById('calendarGrid');
            grid.innerHTML = '';
            
            calendar.forEach(day => {
                const dayEl = document.createElement('div');
                dayEl.className = 'calendar-day';
                if (day.completed) dayEl.classList.add('completed');
                if (day.isToday) dayEl.classList.add('today');
                
                dayEl.innerHTML = `
                    <div class="calendar-day-number">${day.dayNumber}</div>
                    <div class="calendar-day-status">${day.completed ? '‚úÖ' : ''}</div>
                `;
                
                grid.appendChild(dayEl);
            });
            
            document.getElementById('calendarView').classList.remove('hidden');
        }

        function hideCalendar() {
            document.getElementById('calendarView').classList.add('hidden');
        }

        // Show/hide help modal
        function showHelp() {
            document.getElementById('helpModal').classList.remove('hidden');
        }

        function hideHelp() {
            document.getElementById('helpModal').classList.add('hidden');
        }

        // Debug calendar functions
        let debugDate = null;

        // Load debug date from localStorage on page load
        (function() {
            const savedDebugDate = localStorage.getItem('nerdstack_debug_date');
            if (savedDebugDate) {
                debugDate = new Date(savedDebugDate);
                console.log('üêõ Debug mode active:', debugDate.toDateString());
            }
        })();

        function showDebugCalendar() {
            const modal = document.getElementById('debugCalendar');
            const grid = document.getElementById('debugCalendarGrid');
            grid.innerHTML = '';
            
            // Show next 60 days from today
            const today = new Date();
            for (let i = 0; i < 60; i++) {
                const date = new Date(today);
                date.setDate(date.getDate() + i);
                
                const dayBtn = document.createElement('button');
                dayBtn.className = 'btn';
                dayBtn.style.fontSize = '0.75rem';
                dayBtn.style.padding = '0.5rem';
                
                const dateStr = `${date.getMonth() + 1}/${date.getDate()}`;
                const isToday = i === 0;
                
                dayBtn.innerHTML = `${dateStr}${isToday ? '<br>TODAY' : ''}`;
                dayBtn.onclick = () => jumpToDate(date);
                
                grid.appendChild(dayBtn);
            }
            
            modal.classList.remove('hidden');
        }

        function hideDebugCalendar() {
            document.getElementById('debugCalendar').classList.add('hidden');
        }

        function jumpToDate(date) {
            debugDate = new Date(date);
            localStorage.setItem('nerdstack_debug_date', debugDate.toISOString());
            hideDebugCalendar();
            
            // Reload the game with the debug date
            location.reload();
        }

        function resetToToday() {
            localStorage.removeItem('nerdstack_debug_date');
            location.reload();
        }

        function getTodaysSeed() {
            const date = debugDate || new Date();
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return parseInt(`${year}${month}${day}`);
        }

        // ===== GAME LOGIC =====
        
        let currentCategory;
        let todaysCards;
        let stack = [];
        let correctOrder = [];
        let revealedCards = new Set(); // Track which cards have been revealed (by name)
        let lives = 5;
        let checks = 0; // Track number of checks made
        let draggedElement = null;
        let draggedIndex = null;

        function initGame() {
            // Get today's category and cards
            currentCategory = getTodaysCategory();
            todaysCards = getTodaysCards(currentCategory);
            
            console.log('Category:', currentCategory.theme);
            console.log('Cards:', todaysCards);
            
            // Set theme - combine theme and metric into one string
            const combinedTheme = `${currentCategory.theme} ${currentCategory.metric}`.toUpperCase();
            document.getElementById('themeName').textContent = combinedTheme;
            document.documentElement.style.setProperty('--gold', currentCategory.colorScheme.primary);
            document.documentElement.style.setProperty('--gold-light', currentCategory.colorScheme.light);
            
            // Update endpoint labels
            updateEndpointLabels();
            
            // Sort by value descending to get correct order
            correctOrder = [...todaysCards].sort((a, b) => b.value - a.value);
            
            // Shuffle cards for initial stack (deterministic, using different seed)
            const seed = getTodaysSeed();
            stack = seededShuffle([...todaysCards], seed + 12345);
            
            console.log('Correct order:', correctOrder);
            console.log('Initial stack:', stack);
            
            // Reset tracking
            revealedCards = new Set();
            lives = 5;
            checks = 0;
            
            renderGame();
        }

        function updateEndpointLabels() {
            const metric = currentCategory.metric.toLowerCase();
            const theme = currentCategory.theme.toLowerCase();
            let highestLabel = 'HIGHEST';
            let lowestLabel = 'LOWEST';
            
            // Box Office categories
            if (metric.includes('box office')) {
                highestLabel = 'LARGEST BOX OFFICE';
                lowestLabel = 'SMALLEST BOX OFFICE';
            }
            // Year-based metrics
            else if (metric.includes('year') && metric.includes('released')) {
                highestLabel = 'MOST RECENT';
                lowestLabel = 'OLDEST';
            }
            else if (metric.includes('year became')) {
                highestLabel = 'MOST RECENT';
                lowestLabel = 'EARLIEST';
            }
            // Rank-based (lower is better)
            else if (metric.includes('rank')) {
                highestLabel = 'BEST RANK (#1)';
                lowestLabel = 'WORST RANK';
            }
            // Order-based
            else if (metric.includes('order') || metric.includes('appearance')) {
                highestLabel = 'MOST RECENT';
                lowestLabel = 'FIRST';
            }
            // Score-based
            else if (metric.includes('score')) {
                highestLabel = 'HIGHEST SCORE';
                lowestLabel = 'LOWEST SCORE';
            }
            // Episode count
            else if (metric.includes('episode')) {
                highestLabel = 'MOST EPISODES';
                lowestLabel = 'FEWEST EPISODES';
            }
            // Book count
            else if (metric.includes('number of books') || metric.includes('books published')) {
                highestLabel = 'MOST BOOKS';
                lowestLabel = 'FEWEST BOOKS';
            }
            // Sets released
            else if (metric.includes('sets released')) {
                highestLabel = 'MOST SETS';
                lowestLabel = 'FEWEST SETS';
            }
            // Views
            else if (metric.includes('views')) {
                highestLabel = 'MOST VIEWS';
                lowestLabel = 'FEWEST VIEWS';
            }
            // Value/Price
            else if (metric.includes('value') && metric.includes('usd')) {
                highestLabel = 'MOST VALUABLE';
                lowestLabel = 'LEAST VALUABLE';
            }
            // Length/Size
            else if (metric.includes('length') && metric.includes('meters')) {
                highestLabel = 'LONGEST';
                lowestLabel = 'SHORTEST';
            }
            // Sugar content
            else if (metric.includes('sugar')) {
                highestLabel = 'MOST SUGAR';
                lowestLabel = 'LEAST SUGAR';
            }
            // Generic "Number of" categories
            else if (metric.includes('number of')) {
                highestLabel = 'MOST';
                lowestLabel = 'FEWEST';
            }
            
            document.getElementById('highestLabel').textContent = highestLabel;
            document.getElementById('lowestLabel').textContent = lowestLabel;
        }

        function renderGame() {
            renderStack();
            updateStats();
        }

        function renderStack() {
            const stackEl = document.getElementById('stack');
            console.log('Rendering stack, element:', stackEl);
            console.log('Stack data:', stack);
            stackEl.innerHTML = '';
            
            stack.forEach((card, index) => {
                const cardEl = document.createElement('div');
                cardEl.className = 'card stack-card';
                cardEl.draggable = true;
                cardEl.dataset.index = index;
                
                // Check if this specific card has been revealed
                const isRevealed = revealedCards.has(card.name);
                
                cardEl.innerHTML = `
                    <div class="card-content">
                        <div class="card-name">${card.name}</div>
                        <div class="card-value ${isRevealed ? '' : 'hidden'}">
                            ${isRevealed ? card.value : '???'}
                        </div>
                    </div>
                `;
                
                // Drag event listeners
                cardEl.addEventListener('dragstart', handleDragStart);
                cardEl.addEventListener('dragover', handleDragOver);
                cardEl.addEventListener('dragenter', handleDragEnter);
                cardEl.addEventListener('dragleave', handleDragLeave);
                cardEl.addEventListener('drop', handleDrop);
                cardEl.addEventListener('dragend', handleDragEnd);
                
                stackEl.appendChild(cardEl);
            });
        }

        function handleDragStart(e) {
            draggedElement = e.target.closest('.card');
            draggedIndex = parseInt(draggedElement.dataset.index);
            draggedElement.classList.add('dragging');
            
            // Add slight delay to allow CSS transition
            setTimeout(() => {
                draggedElement.style.opacity = '0.4';
            }, 0);
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
        }

        function handleDragEnter(e) {
            e.preventDefault();
            const dropTarget = e.target.closest('.card');
            
            if (!dropTarget || dropTarget === draggedElement) return;
            
            const dropIndex = parseInt(dropTarget.dataset.index);
            
            if (draggedIndex !== null && dropIndex !== draggedIndex) {
                // Visually swap the positions immediately
                const allCards = document.querySelectorAll('.stack-card');
                const draggedCard = allCards[draggedIndex];
                const targetCard = allCards[dropIndex];
                
                // Add visual indicator
                dropTarget.classList.add('drag-over');
                
                // Create a visual preview of the swap
                if (dropIndex < draggedIndex) {
                    // Moving up - insert before target
                    targetCard.parentNode.insertBefore(draggedCard, targetCard);
                } else {
                    // Moving down - insert after target
                    targetCard.parentNode.insertBefore(draggedCard, targetCard.nextSibling);
                }
                
                // Update indices in DOM
                allCards.forEach((card, idx) => {
                    const actualIndex = Array.from(card.parentNode.children).indexOf(card);
                    card.dataset.index = actualIndex;
                });
                
                // Update draggedIndex to new position
                draggedIndex = parseInt(draggedElement.dataset.index);
            }
        }

        function handleDragLeave(e) {
            const dropTarget = e.target.closest('.card');
            if (dropTarget) {
                dropTarget.classList.remove('drag-over');
            }
        }

        function handleDrop(e) {
            e.preventDefault();
            e.stopPropagation();
            
            // Remove all drag-over classes
            document.querySelectorAll('.drag-over').forEach(el => {
                el.classList.remove('drag-over');
            });
            
            // Get final positions from DOM and update stack array
            const cards = document.querySelectorAll('.stack-card');
            const newStack = [];
            
            cards.forEach((cardEl) => {
                const cardName = cardEl.querySelector('.card-name').textContent;
                const card = stack.find(c => c.name === cardName);
                if (card) {
                    newStack.push(card);
                }
            });
            
            stack = newStack;
            
            // Don't re-render - cards are already in position from drag preview
        }

        function handleDragEnd(e) {
            e.target.style.opacity = '';
            e.target.classList.remove('dragging');
            
            // Clean up any remaining drag-over classes
            document.querySelectorAll('.drag-over').forEach(el => {
                el.classList.remove('drag-over');
            });
            
            draggedElement = null;
            draggedIndex = null;
        }

        function checkOrder() {
            // Increment check counter
            checks++;
            
            // Animate the CHECK button
            const checkBtn = document.getElementById('checkBtn');
            checkBtn.classList.add('checking');
            setTimeout(() => {
                checkBtn.classList.remove('checking');
            }, 600);
            
            let allCorrect = true;
            let correctCount = 0;
            const newlyRevealed = [];
            const incorrectIndices = [];
            
            // Check each position and reveal cards that are correct
            stack.forEach((card, index) => {
                const isCorrect = correctOrder[index].name === card.name;
                
                if (isCorrect) {
                    if (!revealedCards.has(card.name)) {
                        newlyRevealed.push(index); // Track which cards are newly revealed
                    }
                    revealedCards.add(card.name); // Reveal this card permanently
                    correctCount++;
                } else {
                    allCorrect = false;
                    incorrectIndices.push(index); // Track incorrect cards
                }
            });
            
            // Re-render to show newly revealed values
            renderStack();
            
            // Trigger animations
            setTimeout(() => {
                const cardEls = document.querySelectorAll('.stack-card');
                
                // Flash gold on newly revealed cards
                newlyRevealed.forEach(index => {
                    if (cardEls[index]) {
                        cardEls[index].classList.add('reveal-flash');
                        setTimeout(() => {
                            cardEls[index].classList.remove('reveal-flash');
                        }, 600);
                    }
                });
                
                // Subtle shake on incorrect cards
                incorrectIndices.forEach(index => {
                    if (cardEls[index]) {
                        cardEls[index].classList.add('incorrect-subtle');
                        setTimeout(() => {
                            cardEls[index].classList.remove('incorrect-subtle');
                        }, 400);
                    }
                });
            }, 50);
            
            if (allCorrect) {
                // Perfect!
                showMessage('üéâ Perfect! All cards in correct order!', 'success');
                
                setTimeout(() => {
                    endGame(true);
                }, 1500);
            } else {
                // Some correct, some not - only positive feedback
                lives--;
                
                if (correctCount > 0) {
                    showMessage(`‚úì ${correctCount} card${correctCount > 1 ? 's' : ''} correct and revealed! Keep going! (${lives} ${lives === 1 ? 'life' : 'lives'} left)`, 'success');
                } else {
                    showMessage(`Keep trying! (${lives} ${lives === 1 ? 'life' : 'lives'} left)`, 'info');
                }
                
                updateStats();
                
                if (lives <= 0) {
                    setTimeout(() => {
                        revealAll();
                        setTimeout(() => endGame(false), 1500);
                    }, 1000);
                }
            }
        }

        function revealAll() {
            // Reveal all cards
            stack.forEach(card => {
                revealedCards.add(card.name);
            });
            renderStack();
        }

        function showMessage(text, type) {
            const msgEl = document.getElementById('message');
            msgEl.innerHTML = `<div class="message ${type}">${text}</div>`;
            setTimeout(() => {
                msgEl.innerHTML = '';
            }, 3000);
        }

        function updateStats() {
            // Update CHECK button text with lives counter
            const checkBtnText = document.getElementById('checkBtnText');
            checkBtnText.textContent = `CHECK ORDER (${lives} ${lives === 1 ? 'life' : 'lives'} left!)`;
        }

        function endGame(isWin) {
            // Mark as completed
            markTodayCompleted();
            
            // Update title
            document.getElementById('gameOverTitle').textContent = isWin ? 
                'SUCCESS! NERDSTACK COMPLETED!' : 
                'OUT OF LIVES!';
            
            // Show confetti if won
            if (isWin) {
                createConfetti();
            }
            
            document.getElementById('gameArea').classList.add('hidden');
            document.getElementById('gameOver').classList.remove('hidden');
            
            const successMsg = isWin ? 
                `Perfect! You sorted all 5 cards correctly in ${checks} ${checks === 1 ? 'check' : 'checks'}!` :
                `Out of lives! You made ${checks} ${checks === 1 ? 'check' : 'checks'}.`;
            document.getElementById('successMessage').textContent = successMsg;
            
            // Start countdown
            setInterval(() => updateCountdown('gameOverCountdown'), 1000);
            updateCountdown('gameOverCountdown');
        }

        function createConfetti() {
            const colors = ['#d4af37', '#f4d03f', '#ffffff', '#e8e8e8'];
            const confettiCount = 150;
            
            for (let i = 0; i < confettiCount; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.width = (Math.random() * 8 + 5) + 'px';
                    confetti.style.height = (Math.random() * 8 + 5) + 'px';
                    confetti.style.animationDuration = (Math.random() * 3 + 2) + 's';
                    
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => confetti.remove(), 5000);
                }, i * 10);
            }
        }

        function restartGame() {
            // Hide game over modal
            document.getElementById('gameOver').classList.add('hidden');
            document.getElementById('gameArea').classList.remove('hidden');
            
            // Clear message
            document.getElementById('message').innerHTML = '';
            
            // Reinitialize game with same daily challenge
            initGame();
        }

        function showCompletedScreen() {
            const key = getDateKey();
            const savedScore = localStorage.getItem(`nerdstack_score_${key}`);
            const savedErrors = localStorage.getItem(`nerdstack_errors_${key}`);
            
            document.getElementById('gameArea').classList.add('hidden');
            document.getElementById('completedScreen').classList.remove('hidden');
            document.getElementById('completedScore').textContent = savedScore || '0';
            document.getElementById('completedMessage').textContent = 
                `You completed today's puzzle with ${savedErrors || '0'} error${savedErrors !== '1' ? 's' : ''}!`;
            
            // Start countdown
            setInterval(() => updateCountdown('countdown'), 1000);
            updateCountdown('countdown');
        }

        // Initialize game on load
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>
